!function(t){function i(o){if(e[o])return e[o].exports;var n=e[o]={exports:{},id:o,loaded:!1};return t[o].call(n.exports,n,n.exports,i),n.loaded=!0,n.exports}var e={};return i.m=t,i.c=e,i.p="",i(0)}([function(t,i,e){t.exports=e(1)},function(t,i,e){e(2),L.MapPath=L.Path.extend({id:null,map:null,smoothFactor:1,pointList:null,pathLine:null,pathLineDecorator:null,origin:null,destination:null,destWAC:null,miles:null,origWAC:null,totalSeats:null,seats_week:null,stops:null,flights:0,visible:!1,onAdd:function(t){this.show()},show:function(){this.visible=!0,null!==this.pathLine&&this.pathLine.addTo(this.map),null!==this.pathLineDecorator&&this.pathLineDecorator.addTo(this.map),null!==this.departureAirport&&this.departureAirport.visible===!1&&this.departureAirport.marker.addTo(this.map),null!==this.arrivalAirport&&this.arrivalAirport.visible===!1&&this.arrivalAirport.marker.addTo(this.map)},hide:function(){this.visible=!1,null!==this.pathLine&&this.map.removeLayer(this.pathLine),null!==this.pathLineDecorator&&this.map.removeLayer(this.pathLineDecorator)},update:function(t){null!==t.departureAirport&&(this.departureAirport=new L.MapNode(t.departureAirport,this.map)),null!==t.arrivalAirport&&(this.arrivalAirport=new L.MapNode(t.arrivalAirport,this.map)),null!==t.Miles&&(this.miles=t.Miles),t["Orig WAC"]&&(this.origWAC=t["Orig WAC"]),null!==t.totalSeats&&(this.totalSeats=t.totalSeats),null!==t["Seats/Week"]&&(this.seats_week=t["Seats/Week"]),this.setPopup()},initialize:function(t,i){return this.map=i,this.visible=!0,this.id=t._id,null!==t.departureAirport&&(this.departureAirport=new L.MapNode(t.departureAirport,this.map)),null!==t.arrivalAirport&&(this.arrivalAirport=new L.MapNode(t.arrivalAirport,this.map)),this.miles=t.Miles,this.origWAC=t["Orig WAC"],this.totalSeats=t.totalSeats,this.seats_week=t["Seats/Week"],this.stops=t.Stops,this.pointList=[this.departureAirport.latlng,this.arrivalAirport.latlng],L.MapPaths.addInitializedPath(this),this.drawPath()},midPoint:function(t,i){var e,o;return e=void 0,o=void 0,o=[],e=Math.abs(t[0].lat-t[1].lat),t[0].lat>t[1].lat?i?o[0]=t[1].lat+e/4:o[0]=t[0].lat-e/4:i?o[0]=t[1].lat+e/4:o[0]=t[1].lat-e/4,o[1]=(t[0].lng+t[1].lng)/2,o},calculateArch:function(){var t,i;return t=void 0,i=void 0,i={geometry:{coordinates:[[this.departureAirport.latlng.lat,this.departureAirport.latlng.lng],this.midPoint([this.departureAirport.latlng,this.arrivalAirport.latlng],!0),[this.arrivalAirport.latlng.lat,this.arrivalAirport.latlng.lng]]}},t=turf.bezier(i,1e4,1),this.pointList=t.geometry.coordinates,this.pointList.push(this.arrivalAirport.latlng)},refresh:function(){return this.setPopup(),this.hide(),this.drawPath(),this.show()},setPopup:function(){var t,i;return t=void 0,i=void 0,i=new L.popup,t=L.DomUtil.create("div",""),Blaze.renderWithData(Template.pathDetails,this,t),i.setContent(t),this.pathLine.bindPopup(i)},setStyle:function(t,i){return this.color=t,this.weight=i},drawPath:function(){var t,i,e,o,n;for(t=void 0,i=void 0,e=void 0,o=void 0,n=void 0,this.visible=!0,t=[],n=L.MapPaths.mapPaths,i=0,e=n.length;e>i;)o=n[i],o!==this&&o.departureAirport.equals(this.departureAirport)&&o.arrivalAirport.equals(this.arrivalAirport)&&(t[o.archPosition]=!0),i++;return this.calculateArch(t),this.pathLine=new L.Polyline(this.pointList,{color:this.color,weight:this.weight,opacity:.8,smoothFactor:1}),this.pathLineDecorator=L.polylineDecorator(this.pathLine,{patterns:[{offset:"50px",repeat:"100px",symbol:new L.Symbol.ArrowHead({pixelSize:20,pathOptions:{color:this.color}})}]}),this.setPopup()}}),L.mapPath=function(t,i){return new L.MapPath(t,i)},L.MapPaths={mapPaths:[],factors:[],getLayerGroup:function(){return L.layerGroup(this.mapPaths)},getFactorById:function(t){var i,e,o,n;for(i=void 0,e=void 0,o=void 0,n=void 0,n=this.factors,e=0,o=n.length;o>e;){if(i=n[e],i._id===t)return i;e++}return!1},getMapPathByFactor:function(t){var i,e,o,n;for(i=void 0,e=void 0,o=void 0,n=void 0,o=this.mapPaths,i=0,e=o.length;e>i;){if(n=o[i],n.departureAirport.id===t.departureAirport._id&&n.arrivalAirport.id===t.arrivalAirport._id)return n;i++}return!1},addInitializedPath:function(t){return this.mapPaths.push(t)},addFactor:function(t,i,e){var o,n;return o=void 0,n=void 0,o=this.getFactorById(t),o!==!1?this.getMapPathByFactor(o):(i._id=t,n=this.getMapPathByFactor(i),n!==!1?n.totalSeats+=i.totalSeats:n===!1&&(n=new L.MapPath(i,e).addTo(e),n.totalSeats=i.totalSeats),this.factors.push(i),n.flights++,n.refresh(),n)},removeFactor:function(t){var i,e,o,n,r,a,s,h,l,p,d,u;return i=void 0,e=void 0,o=void 0,n=void 0,r=void 0,a=void 0,s=void 0,h=void 0,l=void 0,p=void 0,d=void 0,u=void 0,o=this.getFactorById(t),o===!1?!1:(this.factors.splice(this.factors.indexOf(o),1),h=this.getMapPathByFactor(o),h.totalSeats-=o.totalSeats,h.flights--,0===h.flights?(h.arrivalAirport.hide(),h.departureAirport.hide(),h.hide(),!1):(h.show(),{path:h,factor:o}))},updatePath:function(t,i,e){var o,n,r,a,s;for(o=void 0,n=void 0,r=void 0,a=void 0,s=void 0,r=this.mapPaths,a=[],o=0,n=r.length;n>o;)s=r[o],s.id===t?(s.hide(),s.update(i),a.push(s.show())):a.push(void 0),o++;return a},showPath:function(t){return t.show()},hidePath:function(t){return t.hide()},hideAllPaths:function(){var t,i,e,o,n;for(t=void 0,i=void 0,e=void 0,o=void 0,n=void 0,o=this.mapPaths,n=[],t=0,i=o.length;i>t;)e=o[t],n.push(e.hide()),t++;return n},showAllPaths:function(){var t,i,e,o,n;for(t=void 0,i=void 0,e=void 0,o=void 0,n=void 0,o=this.mapPaths,n=[],t=0,i=o.length;i>t;)e=o[t],n.push(e.show()),t++;return n},hideAllNodes:function(){var t,i,e,o,n;for(t=void 0,i=void 0,e=void 0,o=void 0,n=void 0,o=L.MapNodes.mapNodes,n=[],t=0,i=o.length;i>t;)e=o[t],n.push(e.hide()),t++;return n},showAllNodes:function(){return L.MapNodes.showAllNodes()},hideBetween:function(t,i){var e,o,n,r,a;for(e=void 0,o=void 0,n=void 0,r=void 0,a=void 0,r=this.mapPaths,a=[],e=0,o=r.length;o>e;)n=r[e],n.departureAirport===t&&n.arrivalAirport===i&&n.hide(),n.departureAirport===i&&n.arrivalAirport===t?a.push(n.hide()):a.push(void 0),e++;return a}},L.MapNode=L.Path.extend({visible:!1,latlng:null,city:null,state:null,stateName:null,country:null,countryName:null,globalRegion:null,WAC:null,notes:null,code:null,name:null,key:null,map:null,marker:null,onAdd:function(t){null!==this.marker&&this.marker.addTo(t)},onRemove:function(t){t.removeLayer(this.marker)},setPopup:function(){var t,i;return t=void 0,i=void 0,i=new L.popup,t=L.DomUtil.create("div",""),Blaze.renderWithData(Template.nodeDetails,this,t),i.setContent(t),this.marker.bindPopup(i)},initialize:function(t,i){var e,o,n,r;if(e=void 0,o=void 0,n=void 0,r=void 0,this.map=i,this.id=t._id,this.name=t.name,this.city=t.city,this.state=t.state,this.stateName=t.stateName,this.country=t.country,this.countryName=t.countryName,this.globalRegion=t.globalRegion,this.notes=t.notes,this.WAC=t.WAC,this.key=t.key,this.latlng=new L.LatLng(t.loc.coordinates[1],t.loc.coordinates[0]),L.MapNodes.contains(this)){for(n=L.MapNodes.mapNodes,r=[],e=0,o=n.length;o>e;)t=n[e],t.id===this.id?r.push(this.marker=t.marker):r.push(void 0),e++;return r}return this.marker=L.marker(this.latlng),this.marker.on("click",function(t){return Template.map.nodeEvent(L.MapNodes.getNodeByMarker(t.target._leaflet_id))}),L.MapNodes.addInitializedNode(this),this.setPopup()},equals:function(t){return t.latlng.lat===this.latlng.lat&&t.latlng.lng===this.latlng.lng},hide:function(){return this.visible=!1,this.map.removeLayer(this.marker)},show:function(){return this.visible=!0,this.marker=L.marker(this.latlng),this.setPopup()}}),L.MapNodes={selectedNode:null,mapNodes:[],getNodeByMarker:function(t){var i,e,o,n;for(n=this.mapNodes,i=0,e=n.length;e>i;i++)if(o=n[i],o.marker._leaflet_id===t)return o;return!1},getLayerGroup:function(){return L.layerGroup(this.mapNodes)},addInitializedNode:function(t){return this.mapNodes.push(t)},nodeClickEvent:function(t){return alert(t.id)},addNode:function(t){var i,e,o,n,r;for(i=void 0,e=void 0,o=void 0,n=void 0,r=void 0,i=!1,n=this.mapNodes,e=0,o=n.length;o>e;)r=n[e],r.key===t._id&&(i=!0),e++;return i?void 0:new L.MapNode(t,this.map)},removeNode:function(t){var i,e,o,n;for(i=void 0,e=void 0,o=void 0,n=void 0,o=this.mapNodes,i=0,e=o.length;e>i;){if(n=o[i],n.id===t)return n.hide(),void this.mapNodes.splice(this.mapNodes.indexOf(n),1);i++}},updateNode:function(t){var i,e,o,n,r;for(i=void 0,e=void 0,o=void 0,n=void 0,r=void 0,o=this.mapNodes,n=[],i=0,e=o.length;e>i;)r=o[i],r.id===r._id?(r.hide(),r.initialize(t,this.map),n.push(r.show())):n.push(void 0),i++;return n},contains:function(t){var i,e,o,n,r;for(i=void 0,e=void 0,o=void 0,n=void 0,r=void 0,n=!1,r=this.mapNodes,i=0,e=r.length;e>i;)o=r[i],o.id===t.id&&(n=!0),i++;return n},mapNodeCount:function(){return this.mapNodes.length},hideNode:function(t){return t.hide()},showNode:function(t){return t.show()},hideAllNodes:function(){var t,i,e,o,n;for(t=void 0,i=void 0,e=void 0,o=void 0,n=void 0,o=this.mapNodes,n=[],t=0,i=o.length;i>t;)e=o[t],n.push(e.hide()),t++;return n},showAllNodes:function(){var t,i,e,o,n;for(t=void 0,i=void 0,e=void 0,o=void 0,n=void 0,o=this.mapNodes,n=[],t=0,i=o.length;i>t;)e=o[t],n.push(e.show()),t++;return n}},L.mapNode=function(t,i){return new L.MapNode(t,i)}},function(t,i){L.LineUtil.PolylineDecorator={computeAngle:function(t,i){return 180*Math.atan2(i.y-t.y,i.x-t.x)/Math.PI+90},getPointPathPixelLength:function(t){var i=t.length;if(2>i)return 0;for(var e,o=0,n=t[0],r=1;i>r;r++)o+=n.distanceTo(e=t[r]),n=e;return o},getPixelLength:function(t,i){var e=t instanceof L.Polyline?t.getLatLngs():t,o=e.length;if(2>o)return 0;for(var n,r=0,a=i.project(e[0]),s=1;o>s;s++)r+=a.distanceTo(n=i.project(e[s])),a=n;return r},projectPatternOnPath:function(t,i,e,o,n){var r,a=[];for(r=0,l=t.length;r<l;r++)a[r]=n.project(t[r]);var s=this.projectPatternOnPointPath(a,i,e,o);for(r=0,l=s.length;r<l;r++)s[r].latLng=n.unproject(s[r].pt);return s},projectPatternOnPointPath:function(t,i,e,o){var n=[],r=this.getPointPathPixelLength(t)*o,a=this.interpolateOnPointPath(t,i),s=e>0?this.getPointPathPixelLength(t)*e:0;if(n.push(a),o>0){var h=t;h=h.slice(a.predecessor),h[0]=a.pt;for(var l=this.getPointPathPixelLength(h);l-s>=r;)a=this.interpolateOnPointPath(h,r/l),n.push(a),h=h.slice(a.predecessor),h[0]=a.pt,l=this.getPointPathPixelLength(h)}return n},interpolateOnPointPath:function(t,i){var e=t.length;if(2>e)return null;if(0>=i)return{pt:t[0],predecessor:0,heading:this.computeAngle(t[0],t[1])};if(i>=1)return{pt:t[e-1],predecessor:e-1,heading:this.computeAngle(t[e-2],t[e-1])};if(2==e)return{pt:this.interpolateBetweenPoints(t[0],t[1],i),predecessor:0,heading:this.computeAngle(t[0],t[1])};for(var o=this.getPointPathPixelLength(t),n=t[0],r=n,a=0,s=0,h=0,l=1;e>l&&i>s;l++)n=r,a=s,r=t[l],h+=n.distanceTo(r),s=h/o;var p=(i-a)/(s-a);return{pt:this.interpolateBetweenPoints(n,r,p),predecessor:l-2,heading:this.computeAngle(n,r)}},interpolateBetweenPoints:function(t,i,e){return i.x!=t.x?new L.Point(t.x*(1-e)+e*i.x,t.y*(1-e)+e*i.y):new L.Point(t.x,t.y+(i.y-t.y)*e)}},L.PolylineDecorator=L.LayerGroup.extend({options:{patterns:[]},initialize:function(t,i){L.LayerGroup.prototype.initialize.call(this),L.Util.setOptions(this,i),this._map=null,this._initPaths(t),this._initPatterns()},_initPaths:function(t){this._paths=[];if(t instanceof L.Polyline)this._initPath(t.getLatLngs(),t instanceof L.Polygon);else if(L.Util.isArray(t)&&t.length>0)if(t[0]instanceof L.Polyline)for(var i=0;i<t.length;i++)this._initPath(t[i].getLatLngs(),t[i]instanceof L.Polygon);else this._initPath(t)},_isCoordArray:function(t){return L.Util.isArray(t)&&t.length>0&&(t[0]instanceof L.LatLng||L.Util.isArray(t[0])&&2==t[0].length&&"number"==typeof t[0][0])},_initPath:function(t,i){var e;e=this._isCoordArray(t)?[t]:t;for(var o=0;o<e.length;o++)i&&e[o].push(e[o][0]),this._paths.push(e[o])},_initPatterns:function(){this._isZoomDependant=!1,this._patterns=[];for(var t,i=0;i<this.options.patterns.length;i++)t=this._parsePatternDef(this.options.patterns[i]),this._patterns.push(t),this._isZoomDependant=this._isZoomDependant||t.isOffsetInPixels||t.isEndOffsetInPixels||t.isRepeatInPixels||t.symbolFactory.isZoomDependant},setPatterns:function(t){this.options.patterns=t,this._initPatterns(),this._softRedraw()},setPaths:function(t){this._initPaths(t),this.redraw()},_parsePatternDef:function(t,i){var e={cache:[],symbolFactory:t.symbol,isOffsetInPixels:!1,isEndOffsetInPixels:!1,isRepeatInPixels:!1};return"string"==typeof t.offset&&-1!=t.offset.indexOf("%")?e.offset=parseFloat(t.offset)/100:(e.offset=t.offset?parseFloat(t.offset):0,e.isOffsetInPixels=e.offset>0),"string"==typeof t.endOffset&&-1!=t.endOffset.indexOf("%")?e.endOffset=parseFloat(t.endOffset)/100:(e.endOffset=t.endOffset?parseFloat(t.endOffset):0,e.isEndOffsetInPixels=e.endOffset>0),"string"==typeof t.repeat&&-1!=t.repeat.indexOf("%")?e.repeat=parseFloat(t.repeat)/100:(e.repeat=parseFloat(t.repeat),e.isRepeatInPixels=e.repeat>0),e},onAdd:function(t){this._map=t,this._draw(),this._isZoomDependant&&this._map.on("zoomend",this._softRedraw,this)},onRemove:function(t){this._map.off("zoomend",this._softRedraw,this),this._map=null,L.LayerGroup.prototype.onRemove.call(this,t)},_buildSymbols:function(t,i,e){for(var o=[],n=0,r=e.length;r>n;n++)o.push(i.buildSymbol(e[n],t,this._map,n,r));return o},_getCache:function(t,i,e){var o=t.cache[i];return"undefined"==typeof o?(t.cache[i]=[],null):o[e]},_getDirectionPoints:function(t,i){var e=this._map.getZoom(),o=this._getCache(i,e,t);if(o)return o;var n,r,a,s=null,h=this._paths[t];return i.isOffsetInPixels?(s=L.LineUtil.PolylineDecorator.getPixelLength(h,this._map),n=i.offset/s):n=i.offset,i.isEndOffsetInPixels?(s=null!==s?s:L.LineUtil.PolylineDecorator.getPixelLength(h,this._map),r=i.endOffset/s):r=i.endOffset,i.isRepeatInPixels?(s=null!==s?s:L.LineUtil.PolylineDecorator.getPixelLength(h,this._map),a=i.repeat/s):a=i.repeat,o=L.LineUtil.PolylineDecorator.projectPatternOnPath(h,n,r,a,this._map),i.cache[e][t]=o,o},redraw:function(){this._redraw(!0)},_softRedraw:function(){this._redraw(!1)},_redraw:function(t){if(null!==this._map){if(this.clearLayers(),t)for(var i=0;i<this._patterns.length;i++)this._patterns[i].cache=[];this._draw()}},_drawPattern:function(t){for(var i,e,o=0;o<this._paths.length;o++){i=this._getDirectionPoints(o,t),e=this._buildSymbols(this._paths[o],t.symbolFactory,i);for(var n=0;n<e.length;n++)this.addLayer(e[n])}},_draw:function(){for(var t=0;t<this._patterns.length;t++)this._drawPattern(this._patterns[t])}}),L.polylineDecorator=function(t,i){return new L.PolylineDecorator(t,i)},L.RotatedMarker=L.Marker.extend({options:{angle:0},_setPos:function(t){if(L.Marker.prototype._setPos.call(this,t),L.DomUtil.TRANSFORM)this._icon.style[L.DomUtil.TRANSFORM]+=" rotate("+this.options.angle+"deg)";else if(L.Browser.ie){var i=this.options.angle*(Math.PI/180),e=Math.cos(i),o=Math.sin(i);this._icon.style.filter+=" progid:DXImageTransform.Microsoft.Matrix(sizingMethod='auto expand', M11="+e+", M12="+-o+", M21="+o+", M22="+e+")"}},setAngle:function(t){this.options.angle=t}}),L.rotatedMarker=function(t,i){return new L.RotatedMarker(t,i)},L.Symbol=L.Symbol||{},L.Symbol.Dash=L.Class.extend({isZoomDependant:!0,options:{pixelSize:10,pathOptions:{}},initialize:function(t){L.Util.setOptions(this,t),this.options.pathOptions.clickable=!1},buildSymbol:function(t,i,e,o,n){var r=this.options,a=Math.PI/180;if(r.pixelSize<=1)return new L.Polyline([t.latLng,t.latLng],r.pathOptions);var s=e.project(t.latLng),h=-(t.heading-90)*a,l=new L.Point(s.x+r.pixelSize*Math.cos(h+Math.PI)/2,s.y+r.pixelSize*Math.sin(h)/2),p=s.add(s.subtract(l));return new L.Polyline([e.unproject(l),e.unproject(p)],r.pathOptions)}}),L.Symbol.dash=function(t){return new L.Symbol.Dash(t)},L.Symbol.ArrowHead=L.Class.extend({isZoomDependant:!0,options:{polygon:!0,pixelSize:10,headAngle:60,pathOptions:{stroke:!1,weight:2}},initialize:function(t){L.Util.setOptions(this,t),this.options.pathOptions.clickable=!1},buildSymbol:function(t,i,e,o,n){var r,a=this.options;return r=a.polygon?new L.Polygon(this._buildArrowPath(t,e),a.pathOptions):new L.Polyline(this._buildArrowPath(t,e),a.pathOptions)},_buildArrowPath:function(t,i){var e=Math.PI/180,o=i.project(t.latLng),n=-(t.heading-90)*e,r=this.options.headAngle/2*e,a=n+r,s=n-r,h=new L.Point(o.x-this.options.pixelSize*Math.cos(a),o.y+this.options.pixelSize*Math.sin(a)),l=new L.Point(o.x-this.options.pixelSize*Math.cos(s),o.y+this.options.pixelSize*Math.sin(s));return[i.unproject(h),t.latLng,i.unproject(l)]}}),L.Symbol.arrowHead=function(t){return new L.Symbol.ArrowHead(t)},L.Symbol.Marker=L.Class.extend({isZoomDependant:!1,options:{markerOptions:{},rotate:!1},initialize:function(t){L.Util.setOptions(this,t),this.options.markerOptions.clickable=!1,this.options.markerOptions.draggable=!1,this.isZoomDependant=L.Browser.ie&&this.options.rotate},buildSymbol:function(t,i,e,o,n){return this.options.rotate?(this.options.markerOptions.angle=t.heading,new L.RotatedMarker(t.latLng,this.options.markerOptions)):new L.Marker(t.latLng,this.options.markerOptions)}}),L.Symbol.marker=function(t){return new L.Symbol.Marker(t)}}]);
//# sourceMappingURL=grits-net-mapper.js.map